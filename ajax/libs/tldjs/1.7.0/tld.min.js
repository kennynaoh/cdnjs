"use strict";function tld(){this.validHosts=[],this.rules=[]}function trim(t){return String(t).replace(/(^\s+|\s+$)/g,"")}function _someFunction(t,e){if(void 0===t||null===t)throw new TypeError;var n=Object(t),r=n.length>>>0;if("function"!=typeof e)throw new TypeError;for(var l=arguments.length>=3?arguments[2]:void 0,o=0;r>o;o++)if(o in n&&e.call(l,n[o],o,n))return!0;return!1}function _mapFunction(t,e){if(void 0===t||null===t)throw new TypeError;var n=Object(t),r=n.length>>>0;if("function"!=typeof e)throw new TypeError;for(var l=new Array(r),o=arguments.length>=3?arguments[2]:void 0,i=0;r>i;i++)i in n&&(l[i]=e.call(o,n[i],i,n));return l}var Rule=require("./rule.js"),URL=require("url");tld.init=function(){return new tld},tld.getCandidateRule=function(t,e,n){var r={normal:null,exception:null};return n=n||{lazy:!1},_someFunction(e,function(e){var l;return"."+t===e.getNormalXld()?((n.lazy||e.exception||e.isHost)&&(r.normal=e),!0):(l=".+"+e.getNormalPattern()+"$",new RegExp(l).test(t)?(r[e.exception?"exception":"normal"]=e,!e.exception):!1)}),r.normal&&r.exception?r.exception:r.normal},tld.prototype.getRulesForTld=function(t,e){var n="!",r="*",l=!0,o=this.rules[t];return"[object Array]"===Object.prototype.toString.call(o)?o:void 0===o?e?[e]:[]:(o=_mapFunction(o.split("|"),function(e){var o=e[0];return o!==n&&o!==r||(e=e.slice(1),e||(l=!1)),new Rule({firstLevel:t,secondLevel:e,exception:o===n,wildcard:o===r})}),l&&o.unshift(new Rule({firstLevel:t})),this.rules[t]=o.reverse(),o)},tld.prototype.tldExists=function(t){var e;return t=tld.cleanHostValue(t),this.rules[t]?!0:(e=tld.extractTldFromHost(t),void 0!==this.rules[e])},tld.prototype.getPublicSuffix=function(t){var e,n,r;return t in this.rules?t:(t=tld.cleanHostValue(t),e=tld.extractTldFromHost(t),n=this.getRulesForTld(e),r=tld.getCandidateRule(t,n,{lazy:!0}),null===r?null:r.getNormalXld().slice(1))},tld.prototype.getDomain=function(t){var e,n,r,l=null;return this.isValid(t)===!1?null:(t=tld.cleanHostValue(t),e=tld.extractTldFromHost(t),n=this.getRulesForTld(e,new Rule({firstLevel:e,isHost:-1!==this.validHosts.indexOf(e)})),r=tld.getCandidateRule(t,n),null===r?null:(t.replace(new RegExp(r.getPattern()),function(t,e){l=e}),l))},tld.prototype.getSubdomain=function(t){var e,n,r;return t=tld.cleanHostValue(t),e=this.getDomain(t),null===e?null:(n="\\.?"+tld.escapeRegExp(e)+"$",r=t.replace(new RegExp(n,"i"),""))},tld.prototype.isValid=function(t){return"string"==typeof t&&(-1!==this.validHosts.indexOf(t)||-1!==t.indexOf(".")&&"."!==t[0])};var hasPrefixRE=/^(([a-z][a-z0-9+.-]*)?:)?\/\//,invalidHostnameChars=/[^A-Za-z0-9.-]/;tld.cleanHostValue=function(t){t=trim(t).toLowerCase();var e=URL.parse(hasPrefixRE.test(t)?t:"//"+t,null,!0);return e.hostname&&!invalidHostnameChars.test(e.hostname)?e.hostname:invalidHostnameChars.test(t)?"":t},tld.extractTldFromHost=function(t){return t.split(".").pop()},tld.escapeRegExp=function(t){return String(t).replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")},module.exports=tld;
//# sourceMappingURL=tld.min.js.map